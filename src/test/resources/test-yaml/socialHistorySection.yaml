---
testName: "SocialHistorySectionValidation"
testCase:
  eCR-socialHistory-birthsex-pergnancy-travel-occupation:
    testData:
      ClientDataToBeSaved: "R4/Misc/ClientDetails/ClientDataEntry1.json"
      SystemLaunchPayload: "R4/Misc/SystemLaunchPayload/systemLaunchRequest.json"
      BaseXPath: "/ClinicalDocument/component/structuredBody/component[6]/section/"
    resourceMappingData:
      Patient:
      - params: "12742571"
        responseFilePath: "R4/Patient/Patient_12742571.json"
      Encounter:
      - params: "97953900"
        responseFilePath: "R4/Encounter/Encounter_withOneParticipant.json"
      Practitioner:
      - params: "11817978"
        responseFilePath: "R4/Practitioner/Practitioner_11817978.json"
      Organization:
      - params: "675844"
        responseFilePath: "R4/Organization/Organization.json"
      Condition:
      - params:
          patient: "12742571"      
        responseFilePath: "R4/Condition/ConditionBundle_d2572364249.json"
      - params:
          patient: "12742571"
          code: "http%3A//snomed.info/sct%7C77386006"
        responseFilePath: "R4/Condition/CondPergnancy_SCT_77386006.json"
      Observation:
      - params:
          patient: "12742571"
          code: "http%3A//snomed.info/sct%7C34831000175105"
        responseFilePath: "R4/Observation/ObsTravel_SCT_34831000175105.json"
      - params:
          patient: "12742571"
          code: "http%3A//snomed.info/sct%7C224362002"
        responseFilePath: "R4/Observation/ObsOccupation_SCT_224362002.json"
#      - params:
#          patient: "12742571"
#          code: "http%3A%2F%2Floinc.org%7C90767-5"
#        responseFilePath: "R4/Observation/ObservationPernancy-90767-5.json"
#      - params:
#          patient: "12742571"
#          code: "http%3A%2F%2Floinc.org%7C29762-2"
#        responseFilePath: "R4/Observation/ObservationTravel-29762-2.json"
#      - params:
#          patient: "12742571"
#          code: "http%3A%2F%2Fsnomed.info%2Fsct%7C161085007"
#        responseFilePath: "R4/Observation/ObservationTravel-161085007.json"
#      - params:
#          patient: "12742571"
#          code: "http%3A%2F%2Fsnomed.info%2Fsct%7C443846001"
#        responseFilePath: "R4/Observation/ObservationTravel-443846001.json"
    otherMappingData:
      metadata: "R4/Misc/MetaData_r4.json"
      token: "R4/Misc/AccessToken.json"
      default: "R4/Misc/NoDataFound_Default.json"
    validate:
    - xPath: "templateId"
      count: 2
    - xPath: ""
      'templateId[1]/@root': "2.16.840.1.113883.10.20.22.2.17"
      'templateId[2]/@root': "2.16.840.1.113883.10.20.22.2.17"
      'templateId[2]/@extension': "2015-08-01"
      'code/@code': "29762-2"
      'code/@codeSystem': "2.16.840.1.113883.6.1"
      'code/@codeSystemName': "LOINC"
      'code/@displayName': "Social History"      
      title: "SOCIAL HISTORY"
    - xPath: "text/table/thead/tr/th"
      count: 2
    - xPath: "text/table/tbody/tr"
      count: 6
    - xPath: "text/table/tbody/tr[1]/td"
      count: 2
    - xPath: "text/table/"
      'thead/tr/th[1]': "Social History Observation"
      'thead/tr/th[2]': "Social History Observation Result"
#      'tbody/tr[1]/td[1]/content': "Birth Sex"
#      'tbody/tr[1]/td[2]/content': "M"
#      'tbody/tr[2]/td[1]/content': "Pregnancy Condition"
#      'tbody/tr[2]/td[2]/content': "Patient currently pregnant (finding)"
#      'tbody/tr[3]/td[1]/content': "Occupation History"
#      'tbody/tr[3]/td[2]/content': "Student (occupation)"
#      'tbody/tr[4]/td[1]/content': "Occupation History"
#      'tbody/tr[4]/td[2]/content': "Some college"
#      'tbody/tr[5]/td[1]/content': "Travel History"
#      'tbody/tr[5]/td[2]/content': "Travel abroad within past thirty days (finding)-Last travel within 21 days"
#      'tbody/tr[6]/td[1]/content': "Travel History"
#      'tbody/tr[6]/td[2]/content': "Travel abroad within past thirty days (finding)-No recent travel"
    - xPath: "entry"
      count: 6
    - xPath: "entry[1]/observation/templateId"
      count: 1
    - xPath: "entry[1]/observation/id"
      count: 1
    - xPath: "entry[1]/observation/"
      '@classCode': "OBS"
      '@moodCode': "EVN"
      'templateId/@root': "2.16.840.1.113883.10.20.22.4.200"
      'templateId/@extension': "2016-06-01"
#      'id/@root': "2.16.840.1.113883.1.1.1.1"
#      'id/@extension': "M-197293302"
      'code/@code': "76689-9"
      'code/@codeSystem': "2.16.840.1.113883.6.1"
      'code/@codeSystemName': "LOINC"
      'code/@displayName': "Birth Sex"
      'statusCode/@code': "completed"
      'value/@type': "CD"
      'value/@code': "M"
      'value/@codeSystem': "2.16.840.1.113883.5.1"
      'value/@codeSystemName': "Administrative Gender"
#      'value/@displayName': "Male"
    - xPath: "entry[2]/observation/templateId"
      count: 1
    - xPath: "entry[2]/observation/id"
      count: 1
    - xPath: "entry[2]/observation/"
      '@classCode': "OBS"
      '@moodCode': "EVN"
      'templateId/@root': "2.16.840.1.113883.10.20.15.3.8"
#      'templateId/@extension': "2016-06-01"
#      'id/@root': "2.16.840.1.113883.1.1.1.1"
#      'id/@extension': "p73079845"
      'code/@code': "ASSERTION"
      'code/@codeSystem': "2.16.840.1.113883.5.4"
      'code/@codeSystemName': "HL7ActCode"
      'code/@displayName': "Assertion"
      'statusCode/@code': "completed"
#      'effectiveTime/low/@value': "20200101"
#      'effectiveTime/high/@value': "20200101"
      'value/@type': "CD"
      'value/@code': "77386006"
      'value/@codeSystem': "2.16.840.1.113883.6.96"
#      'value/@codeSystemName': "SNOMED-CT"
      'value/@displayName': "Patient currently pregnant (finding)"
    - xPath: "entry[3]/observation/templateId"
      count: 1
    - xPath: "entry[3]/observation/id"
      count: 1
    - xPath: "entry[3]/observation/code/translation"
      count: 2
    - xPath: "entry[3]/observation/"
      '@classCode': "OBS"
      '@moodCode': "EVN"
      'templateId/@root': "2.16.840.1.113883.10.20.22.4.38"
      'templateId/@extension': "2015-08-01"
#      'id/@root': "2.16.840.1.113883.1.1.1.1"
#      'id/@extension': "SH-73079709-q4625873"
      'code/@code': "364703007"
      'code/@codeSystem': "2.16.840.1.113883.6.96"
      'code/@codeSystemName': "SNOMED-CT"
      'code/@displayName': "Employment Detail"
      'code/translation[1]/@code': "11295-3"
      'code/translation[1]/@codeSystem': "2.16.840.1.113883.6.1"
      'code/translation[1]/@codeSystemName': "LOINC"
      'code/translation[1]/@displayName': "Current employment - Reported"
      'code/translation[2]/@code': "224362002"
      'code/translation[2]/@codeSystem': "2.16.840.1.113883.6.96"
      'code/translation[2]/@codeSystemName': "sct"
      'code/translation[2]/@displayName': "Employment status (observable entity)"
      'statusCode/@code': "completed"
#      'effectiveTime/@value': "20200429"
      'value/@type': "CD"
      'value/@code': "65853000"
      'value/@codeSystem': "2.16.840.1.113883.6.96"
      'value/@codeSystemName': "sct"
      'value/@displayName': "Student (occupation)"
    - xPath: "entry[4]/observation/templateId"
      count: 1
    - xPath: "entry[4]/observation/id"
      count: 1
    - xPath: "entry[4]/observation/code/translation"
      count: 2
    - xPath: "entry[4]/observation/"
      '@classCode': "OBS"
      '@moodCode': "EVN"
      'templateId/@root': "2.16.840.1.113883.10.20.22.4.38"
      'templateId/@extension': "2015-08-01"
#      'id/@root': "2.16.840.1.113883.1.1.1.1"
#      'id/@extension': "SH-73079709-q4625889"
      'code/@code': "364703007"
      'code/@codeSystem': "2.16.840.1.113883.6.96"
      'code/@codeSystemName': "SNOMED-CT"
      'code/@displayName': "Employment Detail"
      'code/translation[1]/@code': "11295-3"
      'code/translation[1]/@codeSystem': "2.16.840.1.113883.6.1"
      'code/translation[1]/@codeSystemName': "LOINC"
      'code/translation[1]/@displayName': "Current employment - Reported"
      'code/translation[2]/@code': "82589-3"
      'code/translation[2]/@codeSystem': "2.16.840.1.113883.6.1"
      'code/translation[2]/@codeSystemName': "loinc.org"
#      'code/translation[2]/@displayName': "SHX Highest education level)"
      'statusCode/@code': "completed"
#      'effectiveTime/@value': "20200429"
      'value/@type': "CD"
      'value/@code': "LA12458-8"
      'value/@codeSystem': "2.16.840.1.113883.6.1"
      'value/@codeSystemName': "loinc.org"
#      'value/@displayName': "Some college"
#    - xPath: "entry[5]"
#      '@typeCode': "DRIV"
    - xPath: "entry[5]/act/templateId"
      count: 1
    - xPath: "entry[5]/act/id"
      count: 1
    - xPath: "entry[5]/act/"
      '@classCode': "ACT"
      '@moodCode': "EVN"
      'templateId/@root': "2.16.840.1.113883.10.20.15.2.3.1"
      'templateId/@extension': "2016-12-01"
#      'id/@root': "2.16.840.1.113883.1.1.1.1"
#      'id/@extension': "M-197293302"
      'code/@code': "420008001"
      'code/@codeSystem': "2.16.840.1.113883.6.96"
      'code/@codeSystemName': "SNOMED-CT"
      'code/@displayName': "Travel"
      'text': "Travel abroad within past thirty days (finding)-Last travel within 21 days"
      'statusCode/@code': "completed"
#      'effectiveTime/@value': "20200728"
#    - xPath: "entry[6]"
#      '@typeCode': "DRIV"
    - xPath: "entry[6]/act/templateId"
      count: 1
    - xPath: "entry[6]/act/id"
      count: 1
    - xPath: "entry[6]/act/"
      '@classCode': "ACT"
      '@moodCode': "EVN"
      'templateId/@root': "2.16.840.1.113883.10.20.15.2.3.1"
      'templateId/@extension': "2016-12-01"
#      'id/@root': "2.16.840.1.113883.1.1.1.1"
#      'id/@extension': "M-197286965"
      'code/@code': "420008001"
      'code/@codeSystem': "2.16.840.1.113883.6.96"
      'code/@codeSystemName': "SNOMED-CT"
      'code/@displayName': "Travel"
      'text': "Travel abroad within past thirty days (finding)-No recent travel"
      'statusCode/@code': "completed"
#      'effectiveTime/@value': "20200428"
